function ptiles = GetPercentiles(p,w,x)

T       = length(x);
n       = length(p);
ptiles  = zeros(length(p),T);

try
for t=1:T;
    [s ind]    = sort(x(:,t));
    cumw        = cumsum(w(ind,t));
    for i=1:n
        ptiles(i,t) = s(find(cumw>p(i),1));
    end
end

catch
    ass=4
end